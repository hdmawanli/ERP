{% extends 'base.html' %}
{% block title %}采购订单列表{% endblock %}
{% block content %}
<div class="page-header">
    <div class="page-title">采购订单列表</div>
</div>

<!-- 查询表单 -->
<form class="query-form">
    <div class="form-row">
        <div class="form-group">
            <label for="order_no">订单号</label>
            <input type="text" id="order_no" name="order_no" placeholder="输入订单号" value="{{ order_no or '' }}">
        </div>
        <div class="form-group">
            <label for="supplier_name">供应商</label>
            <input type="text" id="supplier_name" name="supplier_name" placeholder="输入供应商名称" value="{{ supplier_name or '' }}">
        </div>
        <div class="form-group">
            <label for="status">状态</label>
            <select id="status" name="status">
                <option value="">所有状态</option>
                <option value="1" {% if status == '1' %}selected{% endif %}>待收货</option>
                <option value="2" {% if status == '2' %}selected{% endif %}>已收货</option>
                <option value="3" {% if status == '3' %}selected{% endif %}>已取消</option>
            </select>
        </div>
    </div>
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">查询</button>
        <a href="{{ url_for('purchase.index') }}" class="btn btn-secondary">重置</a>
        <a href="{{ url_for('purchase.add_order') }}" class="btn btn-success">添加采购订单</a>
    </div>
</form>

<!-- 数据表格 -->
<table class="data-table">
  <thead>
    <tr>
        <th>ID</th>
        <th>订单号</th>
        <th>供应商</th>
        <th>总价</th>
        <th>状态</th>
        <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for o in orders %}
    <tr>
      <td>{{ o.order_id }}</td>
      <td>{{ o.order_no }}</td>
      <td>{{ o.supplier.supplier_name if o.supplier else o.supplier_id }}</td>
      <td>{{ o.total_amount }}</td>
      <td>
          {% if o.status == 0 %}
              <span class="status-cancelled">已取消</span>
          {% elif o.status == 1 %}
              <span class="status-pending">待审核</span>
          {% elif o.status == 2 %}
              <span class="status-approved">已审核</span>
          {% elif o.status == 3 %}
              <span class="status-completed">已完成</span>
          {% else %}
              <span class="status-unknown">未知</span>
          {% endif %}
      </td>
      <td>
          <a href="{{ url_for('purchase.order_detail', order_id=o.order_id) }}" class="btn btn-sm btn-info">详情</a>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="6" class="empty-row">没有记录</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
